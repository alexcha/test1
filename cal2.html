    // (이전 코드 생략)

    // --- Dynamic Purchase Entry Handlers (DCA only) ---
    
    // (중략)

    function aggregateDCAValues() {
        let totalNewCost = 0;
        let totalNewQuantity = 0;
        
        const entries = document.querySelectorAll('#dca_purchaseEntriesContainer .purchase-entry');
        
        entries.forEach(entry => {
            const id = entry.dataset.id;
            const priceInput = document.getElementById(`dca_price-${id}`);
            const qtyInput = document.getElementById(`dca_qty-${id}`);
            
            const price = parseFloat(priceInput.value.replace(/,/g, '')) || 0;
            const quantity = Math.floor(parseFloat(qtyInput.value.replace(/,/g, '')) || 0);

            if (quantity > 0) {
                totalNewQuantity += quantity;
                totalNewCost += price * quantity;
            }
        });

        // ✨ 수정/강화된 부분: 물타기 매수 정보 입력 섹션 하단에 총 추가 매수 금액/수량 표시
        document.getElementById('dca_totalNewPurchase').innerText = 
            `${formatCurrency(totalNewQuantity, 0)} 주 / ${formatCurrency(totalNewCost, 0)} 원`;
        
        return { totalNewCost, totalNewQuantity };
    }
    
    // (이후 코드 생략)
