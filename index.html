<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주요 도구 통합 탭 보기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter 폰트 설정 및 기본 스타일 */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            /* body의 margin/padding 제거: 전체 화면 사용 보장 */
            margin: 0;
            padding: 0;
        }
        #app {
            min-height: 100vh;
        }

        /* ⭐️ iFrame 컨테이너 높이 계산 (하단 탭 공간을 90px에서 60px로 줄여 높이 확장) */
        .iframe-fixed-height {
            /* 100vh - (최소화된 상단 탭 높이 + 하단 여백) -> 60px로 수정 */
            height: calc(100vh - 60px); 
        }

        /* iFrame이 부모 높이를 채우도록 합니다. */
        .tab-pane iframe {
            width: 100%;
            height: 100%;
            border: 0;
        }
    </style>
</head>
<body class="flex flex-col">

    <div id="app" class="w-full mx-auto px-1 flex flex-col">
        
        <div class="flex bg-white p-2 rounded-xl shadow-md space-x-2 mb-2 sticky top-0 z-10">
            <button id="tab-money"
                    class="tab-button flex-1 py-1 px-4 text-sm font-semibold rounded-lg transition-all duration-200"
                    data-tab="money">
                매출
            </button>
            <button id="tab-cal"
                    class="tab-button flex-1 py-1 px-4 text-sm font-semibold rounded-lg transition-all duration-200"
                    data-tab="cal">
                매도 계산기
            </button>
            <button id="tab-cal2"
                    class="tab-button flex-1 py-1 px-4 text-sm font-semibold rounded-lg transition-all duration-200"
                    data-tab="cal2">
                물타기
            </button>
        </div>

        <div id="tab-content" class="bg-white p-0 rounded-xl shadow-xl overflow-hidden flex flex-col">

            <div id="content-money" class="tab-pane w-full overflow-y-auto iframe-fixed-height hidden">
                <iframe id="iframe-money" src="money.html"></iframe>
            </div>

            <div id="content-cal" class="tab-pane w-full overflow-y-auto iframe-fixed-height hidden">
                <iframe id="iframe-cal" src="cal.html"></iframe>
            </div>
            
            <div id="content-cal2" class="tab-pane w-full overflow-y-auto iframe-fixed-height hidden">
                <iframe id="iframe-cal2" src="cal2.html"></iframe>
            </div>
            
            <div id="instruction-message" class="p-8 text-center text-gray-500">
                <p class="text-xl font-bold text-indigo-600">파일 내용을 보려면 탭을 선택하세요.</p>
                <p class="text-sm mt-3 border-t pt-3">
                    **주의:** 이 HTML 파일과 **같은 폴더**에 세 개의 파일이 있어야 합니다.
                </p>
            </div>

        </div>
    </div>

    <script>
        // JavaScript for Tab Functionality

        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanes = document.querySelectorAll('.tab-pane');
            const instructionMessage = document.getElementById('instruction-message');
            const LAST_TAB_KEY = 'lastActiveTab'; // localStorage 키
            
            // 1. 마지막으로 저장된 탭 이름 로드 (없으면 'money' 기본값)
            const initialTab = localStorage.getItem(LAST_TAB_KEY) || 'money';

            function switchTab(tabName) {
                // 탭 이름을 저장합니다.
                localStorage.setItem(LAST_TAB_KEY, tabName);

                // 1. 버튼 스타일 업데이트
                tabButtons.forEach(button => {
                    const isActive = button.getAttribute('data-tab') === tabName;
                    
                    if (isActive) {
                        button.classList.add('bg-indigo-600', 'text-white', 'shadow-lg');
                        button.classList.remove('bg-gray-100', 'text-gray-700', 'hover:bg-indigo-50');
                    } else {
                        button.classList.remove('bg-indigo-600', 'text-white', 'shadow-lg');
                        button.classList.add('bg-gray-100', 'text-gray-700', 'hover:bg-indigo-50');
                    }
                });

                // 2. 내용 패널 업데이트 및 iFrame 새로고침
                tabPanes.forEach(pane => {
                    if (pane.id === `content-${tabName}`) {
                        pane.classList.remove('hidden');
                        
                        // ⭐️ iFrame 새로고침 (캐싱 문제 해결)
                        const iframe = document.getElementById(`iframe-${tabName}`);
                        if (iframe) {
                            // 현재 src 값을 가져와서, 캐시 무시를 위한 쿼리 파라미터(현재 시간)를 추가합니다.
                            let src = iframe.getAttribute('src').split('?')[0];
                            iframe.src = `${src}?_t=${new Date().getTime()}`;
                        }
                    } else {
                        pane.classList.add('hidden');
                    }
                });

                // 3. 안내 메시지 숨기기 (탭이 선택되면)
                if (instructionMessage) {
                    instructionMessage.classList.add('hidden');
                }
            }

            // 이벤트 리스너 부착
            tabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const tabName = e.currentTarget.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });

            // 초기 로드 시 마지막으로 활성화되었던 탭을 활성화합니다.
            // iFrame에 ID를 추가했으므로, 초기 로드 시에도 switchTab을 사용하여 새로고침 로직을 태웁니다.
            switchTab(initialTab); 
        });
    </script>
</body>
</html>

